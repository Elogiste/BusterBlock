-- ===================================================================
-- 1. Cr√©ation des tables
-- ===================================================================

DROP TABLE IF EXISTS utilisateurs_roles;
DROP TABLE IF EXISTS utilisateurs;
DROP TABLE IF EXISTS roles;

CREATE TABLE IF NOT EXISTS utilisateurs (
    id VARCHAR(255) PRIMARY KEY,
    nom VARCHAR(255) NOT NULL,
    prenom VARCHAR(255),
    courriel VARCHAR(255) UNIQUE NOT NULL,
    mot_de_passe VARCHAR(255) NOT NULL,
    date_creation TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS roles (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nom VARCHAR(255) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS utilisateurs_roles (
    utilisateur_id VARCHAR(255) NOT NULL,
    role_id INT NOT NULL,
    PRIMARY KEY (utilisateur_id, role_id),
    FOREIGN KEY (utilisateur_id) REFERENCES utilisateurs(id) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE ON UPDATE CASCADE
);
